"""
计算多个数组之间的相关性的函数
"""

import numpy as np
from scipy.stats import pearsonr

def calculate_correlations(target_array, *other_arrays):
    """
    计算目标数组与多个其他数组之间的皮尔逊相关系数。

    参数:
    target_array (np.array): 目标数组。
    *other_arrays (np.array): 可变数量的其他数组。

    返回:
    np.array: 包含目标数组与其他每个数组之间皮尔逊相关系数绝对值的数组。
    """
    correlations = []
    target_array = np.array(target_array)
    
    # 计算目标数组与每个其他数组之间的相关系数
    for other_array in other_arrays:
        other_array = np.array(other_array)
        corr_coefficient, _ = pearsonr(target_array, other_array)
        correlations.append(np.abs(corr_coefficient))
    
    return np.array(correlations)


a1 = [3.4304166666666664, 5.051833333333334, 5.052833333333333, 5.281666666666666, 5.6810833333333335, 5.85225, 5.816166666666667, 5.801666666666667, 5.47175, 5.9485, 5.539083333333333, 5.684583333333333, 5.4446666666666665, 5.815916666666666, 5.363333333333333, 5.543333333333333, 5.6193333333333335, 5.454666666666666, 5.56025, 6.0616666666666665, 5.7515, 6.239833333333333, 6.253666666666667, 5.88175, 5.6321666666666665, 6.167666666666666, 5.86, 5.82875, 5.69175, 5.719916666666666]
a2 =  [115, 127, 125, 124, 135, 123, 133, 139, 102, 126, 140, 133, 126, 128, 129, 117, 126, 139, 134, 119, 134, 148, 142, 124, 123, 133, 136, 120, 135, 128]
a3 =  [131.5, 141.0, 136.0, 135.5, 144.0, 131.5, 142.0, 150.5, 123.0, 128.5, 146.0, 135.5, 128.5, 135.0, 140.0, 119.0, 138.0, 140.5, 136.0, 133.0, 141.0, 143.5, 141.5, 140.0, 136.0, 141.5, 144.0, 130.5, 139.5, 141.0]
a4 = [9, 14,13, 13,11,15, 14, 16, 16, 14, 12, 15, 14,17, 19, 15, 17, 17, 19, 19, 19,  15, 14, 14, 17, 20, 16, 15, 21,  21]
at = [1.2899599799776784, 1.090087841268682, 0.9244703067744924, 0.8017528725927834, 0.7252335781338342, 0.6662704618891733, 0.6099678502480004, 0.564648455007724, 0.5149578502542435, 0.4960704144220892, 0.485335330127972, 0.4570776755924062, 0.4561089670250202, 0.4382354387360604, 0.409966312309757, 0.3934222531397352, 0.3756536950724429, 0.3666391271972302, 0.3680922167539039, 0.3573766431476866, 0.3481833184542614, 0.3423076372880358, 0.3374786736261652, 0.3484238759068173, 0.3475705996916899, 0.3435314125792775, 0.3451456832447857, 0.3484377184705598, 0.3435937207986907, 0.3422906931118308]

ans = calculate_correlations(at, a1, a2, a3, a4)
print("相关系数绝对值数组:", ans)